<view class="container">
  <!-- 欢迎区域 -->
  <view class="welcome-section">
    <view class="welcome-content">
      <view class="welcome-text">{{welcomeText}}</view>
      <view class="welcome-subtext">{{welcomeSubtext}}</view>

      <!-- 登录按钮 - 仅游客显示 -->
      <button 
        wx:if="{{isGuest}}" 
        class="login-btn" 
        bindtap="showLoginGuide"
      >
        登录/注册 →
      </button>
    </view>
    
    <view class="welcome-extra">
      <!-- 用户头像显示 - 区分游客和登录用户 -->
      <image 
        src="{{userInfo.isGuest ? '/images/function/func-guest.png' : (userInfo.avatarUrl || '/images/page/page-profile.png')}}" 
        mode="widthFix" 
        class="user-avatar" 
      />
    </view>
  </view>

  <!-- 统计卡片 -->
  <view class="stats-container">
    <!-- 器材总数卡片 -->
    <view class="stat-card total" bindtap="goToManage" data-status="all">
      <image src="/images/status/status-all.png" mode="widthFix" class="stat-icon" />
      <view class="stat-value">{{totalEquipments}}</view>
      <view class="stat-label">总器材数</view>
    </view>
    
    <view class="stat-card available" bindtap="goToManage" data-status="在库">
      <image src="/images/status/status-available.png" mode="widthFix" class="stat-icon" />
      <view class="stat-value">{{availableEquipments}}</view>
      <view class="stat-label">可借器材</view>
    </view>
    
    <view class="stat-card borrowed" bindtap="goToManage" data-status="借出">
      <image src="/images/status/status-borrowed.png" mode="widthFix" class="stat-icon" />
      <view class="stat-value">{{borrowedEquipments}}</view>
      <view class="stat-label">已借器材</view>
    </view>
  </view>

  <!-- 最近活动记录区域 -->
  <view class="section-title">
    <text>最近操作记录</text>
  </view>

  <!-- 活动记录列表 -->
  <view class="activity-list-container">
    <view wx:if="{{recentActivities.length === 0}}" class="empty-activity">
      <image src="/images/function/record-no.png" mode="widthFix" class="empty-activity-icon" />
      <text>暂无操作记录</text>
    </view>
    
    <view class="activity-list" wx:else>
      <view 
        class="activity-item" 
        wx:for="{{recentActivities}}" 
        wx:key="id"
      >
        <!-- 活动类型图标 -->
        <view class="activity-icon {{_getActivityTypeStyle(item.type).className}}">
          <image src="{{_getActivityTypeStyle(item.type).icon}}" mode="widthFix" class="activity-icon-img" />
          <text class="action-keyword">{{_getActionKeyword(item.type)}}</text>
          <view class="activity-badge">{{_getActivityTypeStyle(item.type).badgeText}}</view>
        </view>
        
        <!-- 活动内容 -->
        <view class="activity-content">
          <view class="activity-text">
            {{item.content}}
            <text class="view-detail">点击查看详情</text>
          </view>
          <view class="activity-time">{{item.formattedTime}}</view>
        </view>
      </view>
    </view>
  </view>

  <!-- 悬浮按钮 -->
  <view class="fab {{fabOpen ? 'open' : ''}}" bindtap="toggleFab">
    <image src="/images/status/add-white.png" mode="widthFix" class="fab-icon" />
  </view>
  
  <!-- 悬浮菜单 -->
  <view class="fab-menu {{fabOpen ? 'show' : ''}}">
    <view class="fab-item" bindtap="handleFabAction" data-action="scan">
      <image src="/images/function/func-scan.png" mode="widthFix" class="menu-item-icon" />
      <text>扫码入库</text>
    </view>
    <!-- 新增二维码生成入口 -->
    <view class="fab-item" bindtap="handleFabAction" data-action="qrcode">
      <image src="/images/function/func-qrcode.png" mode="widthFix" class="menu-item-icon" />
      <text>QR生成</text>
    </view>
    <view class="fab-item" bindtap="handleFabAction" data-action="sync">
      <image src="/images/function/func-sync.png" mode="widthFix" class="menu-item-icon" />
      <text>同步数据</text>
    </view>
  </view>
</view>
    